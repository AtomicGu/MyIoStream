//==================================================================================================
// 文件：CmdHelp.h
// 作者：顾宇浩
// 简介：帮助命令类
// 上次修改：2020-5-15 (v1.0.1)
//==================================================================================================

#pragma once
#include "debug_server.h"



//==================================================================================================
// 类名：CmdHelp
// 说明：
//		一个简单的帮助指令，可选地接受一个或多个指令名作为参数
//		若指令没有参数，则打印指令表中所有可用指令；
//		若参数是有效的指令名，则打印对应命令的详细信息。
//==================================================================================================
class CmdHelp :public DebugCmd
{
public:
	//==============================================================================================
	// 函数：构造（重载）
	// 参数：ds - 调试服务器对象
	// 说明：无
	//==============================================================================================
	CmdHelp(DebugServer& ds) :_cmdMap(ds.cmd_map()) {}

	//==============================================================================================
	// 函数：构造（重载）
	// 参数：cmdMap - 调试指令表对象
	// 说明：无
	//==============================================================================================
	CmdHelp(DebugCmdMap& cmdMap) :_cmdMap(cmdMap) {}

public:
	//==============================================================================================
	// 函数：info
	// 参数：无
	// 返回：存放详情信息的C字符串
	// 说明：这个函数是对DebugCmd接口的实现
	//==============================================================================================
	virtual const char* info();

	//==============================================================================================
	// 函数：operator()
	// 参数：
	//		in - 参数输入流
	//		out - 命令使用的输出流
	//
	// 返回：始终返回true
	// 说明：这个函数是对DebugCmd接口的实现
	//==============================================================================================
	virtual bool operator()(ICharStream& in, OCharStream out);

private:
	DebugCmdMap& _cmdMap;
};



//==================================================================================================
// inlines: CmdHelp
//==================================================================================================

inline const char* CmdHelp::info()
{
	return R"(show help info

Usage:
  <$cmd> [cmdName]

If no command specified, show all avaliable commands.
)";
}
