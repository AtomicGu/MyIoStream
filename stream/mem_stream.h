//==================================================================================================
// 文件：mem_stream.h
// 作者：顾宇浩
// 简介：内存字节流
// 上次修改：2020-5-9 (v1.1.0)
//==================================================================================================

#pragma once
#include <cstddef>
#include "byte_stream.h"



//==================================================================================================
// 类名：IMemStream
// 说明：内存输入流类，用于包装内存空间以符合字节流接口。
//==================================================================================================
class IMemStream :public IByteStream
{
public:
	//==============================================================================================
	// 函数：构造
	// 参数：
	//		p - 起始地址
	//		size - 大小
	//
	// 说明：请小心指针悬挂
	//==============================================================================================
	IMemStream(void* p, size_t size) :_p((Byte*)p), _end_p((Byte*)p + size) {}

public:
	//==============================================================================================
	// 函数：get
	// 参数：p - 存放取出元素的指针
	// 返回：成功返回true；失败返回false
	// 说明：从流中取出一个元素
	//==============================================================================================
	virtual bool get(Byte* p) { return (_p == _end_p) ? false : (*p = *_p++, true); }

private:
	Byte* _p;
	Byte* _end_p;
};
